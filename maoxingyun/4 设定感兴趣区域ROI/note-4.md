# 设定感兴趣区域ROI

在图像处理领域，我们常常需要设置感兴趣区域(ROI，region of interest)，来专注或者简化我们的工作过程 。

也就是从图像中选择的一个图像区域，这个区域是我们图像分析所关注的重点。我们圈定这个区域，以便进行进一步处理。  
而且，使用ROI指定我们想读入的目标，可以减少处理时间，增加精度，给图像处理来带不小的便利。

定义ROI有两种方法，一种是使用 ```cv::Rect```，另一种方式是指定感兴趣行或列的范围。

<br>

- cv::Rect

    顾名思义，```cv::Rect```表示一个矩形区域

    指定矩形的左上角坐标（构造函数的前两个参数）和矩形的长宽（构造函数的后两个参数）就可以定义一个矩形区域。

    ```C++
    Mat imageROI = image1(Rect(800, 350, image2.cols, image2.rows));
    ```

- Range

    指定感兴趣行或列的范围

    Range是指从起始索引到终止索引（不包括终止索引）的一连段连续序列。

    ```C++
    Mat imageROI = image1(Range(350, 350 + image2.rows), Range(800, 800 + image2. cols));
    ```

**注意：两种方法的xy排列顺序不同**

<Br>

# 线性混合操作

线性混合操作是一种典型的二元（两个输入）的像素操作，它的理论公式是这样的：

$$
g(x) = (1-a)f_0(x) + af_1(x)
$$


> 类似$alpha$混合
>
> 通过在范围0到1之间改变$alpha$值，来对两幅图像（$f_0（x）和f_1（x）$）或两段视频（同样为（$f_0（x）和f_1（x）$）产生时间上的画面叠化（cross-dissolve）效果，就像幻灯片放映和电影制作中的那样。
>
> 即在幻灯片翻页时设置的前后页缓慢过渡叠加效果，以及电影情节过渡时经常出现的画面叠加效果。

<br>

## addWeight
这个函数的作用是，计算两个数组（图像阵列）的加权和。

原型如下：
```C++
void addWeighted(InputArray src1, double alpha, InputArray src2, double beta, double gamma, OutputArray dst, int dtype=-1);
```
- 第一个参数，```InputArray```类型的```src1```，表示需要加权的第一个数组，常常填一个```Mat```。
- 第二个参数，```alpha```，表示第一个数组的权重
- 第三个参数，```src2```，表示第二个数组，它需要和第一个数组拥有相同的尺寸和通道数。
- 第四个参数，```beta```，表示第二个数组的权重值。
- 第五个参数，```dst```，输出的数组，它和输入的两个数组拥有相同的尺寸和通道数。
- 第六个参数，```gamma```，一个加到权重总和上的标量值。看下面的式子自然会理解。
- 第七个参数，```dtype```，输出阵列的可选深度，有默认值-1。;当两个输入数组具有相同的深度时，这个参数设置为-1（默认值），即等同于```src1.depth()```。

<br>

如果用数学公式来表达，```addWeighted```函数计算如下两个数组（```src1```和```src2```）的加权和，得到结果输出给第四个参数。即```addWeighted```函数的作用可以被表示为为如下的矩阵表达式为：
$$
dst = src1[I]*alpha+ src2[I]*beta + gamma;
$$
其中的I，是多维数组元素的索引值。  
**在遇到多通道数组的时候，每个通道都需要独立地进行处理。**   
另外需要注意的是，当输出数组的深度为```CV_32S```时，这个函数就不适用了，这时候就会内存溢出或者算出的结果压根不对。
